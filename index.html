<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creator Profile — Enhanced Media Viewers</title>
    <style>
        :root {
            --bg: #f9fafb;
            --fg: #111827;
            --accent: #2563eb;
            --muted: #6b7280;
            --radius: 20px;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
        }
        body { 
            margin: 0; 
            background: var(--bg); 
            color: var(--fg); 
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 0 16px; 
        }

        /* Header Styles - FIXED */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 16px; /* Changed from 20px to match container */
            background-color: #ffffff;
            border-bottom: 1px solid #dbdbdb;
            position: sticky;
            top: 0;
            z-index: 100;
            box-sizing: border-box;
        }
        .hamburger {
            cursor: pointer;
            padding: 10px;
            position: relative;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 44px;
            width: 44px;
        }
        .hamburger div {
            width: 25px;
            height: 3px;
            background-color: #262626;
            margin: 2.5px 0; /* Adjusted margin for better centering */
            transition: all 0.3s ease;
        }
        .hamburger.active div:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        .hamburger.active div:nth-child(2) {
            opacity: 0;
        }
        .hamburger.active div:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
        .title {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
            padding: 0;
            line-height: 1.2;
        }
        
        /* Compact Navigation Menu */
        .menu {
            position: fixed;
            top: 50px;
            right: 20px;
            width: 180px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(-10px) scale(0.95);
            visibility: hidden;
            z-index: 999;
            padding: 10px 0;
        }
        .menu.active {
            opacity: 1;
            transform: translateY(0) scale(1);
            visibility: visible;
        }
        .menu ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .menu ul li {
            margin: 0;
        }
        .menu ul li a {
            display: block;
            padding: 12px 20px;
            text-decoration: none;
            color: #333;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .menu ul li a:hover {
            background-color: #f0f0f0;
        }
        .menu-close {
            display: none;
        }

        /* Profile Section */
        .profile { 
            text-align: center; 
            padding: 1rem; 
        }
        .profile-pic-wrapper { 
            position: relative; 
            display: inline-block; 
        }
        .profile-pic-wrapper.has-story {
            position: relative;
            padding: 4px;
            background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
            border-radius: 50%;
        }
        .profile-pic-wrapper.has-story .profile-pic {
            border: 3px solid var(--bg);
            position: relative;
            z-index: 1;
        }
        .profile img.profile-pic { 
            width: 120px; 
            height: 120px; 
            border-radius: 50%; 
            object-fit: cover; 
            cursor: pointer; 
            display: block; 
        }
        .creator-name { 
            font-size: 1.5rem; 
            font-weight: 600; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: .3rem; 
            margin-top: .5rem; 
        }
        .verified { 
            color: var(--accent); 
            font-size: 1.2rem; 
        }
        .username { 
            color: var(--muted); 
            margin-bottom: .5rem; 
            font-size: 1rem;
        }
        .stats { 
            display: flex; 
            justify-content: center; 
            gap: 2rem; 
            margin: 1rem 0; 
        }
        .stat strong { 
            display: block; 
            font-size: 1.2rem; 
        }
        .actions { 
            display: flex; 
            gap: .8rem; 
            justify-content: center; 
            margin-bottom: 1rem; 
        }
        .actions button { 
            flex: 1; 
            padding: .8rem 1.2rem; 
            border-radius: var(--radius); 
            border: 0; 
            cursor: pointer; 
            font-weight: 600; 
            font-size: 1.1rem; 
        }
        .subscribe { 
            background: var(--accent); 
            color: white; 
        }
        .message { 
            background: #e5e7eb; 
        }
        .donate { 
            background: #facc15; 
        }

        /* Tabs */
        .tabs { 
            display: flex; 
            justify-content: center; 
            gap: 1.5rem; 
            margin: 1.5rem 0; 
            border-bottom: 2px solid #e5e7eb; 
            padding-bottom: 0.5rem; 
        }
        .tab-btn { 
            background: none; 
            border: none; 
            padding: .6rem 1.2rem; 
            cursor: pointer; 
            font-weight: 600; 
            color: var(--muted); 
            font-size: 1.1rem; 
        }
        .tab-btn.active { 
            color: var(--accent); 
            border-bottom: 3px solid var(--accent); 
        }
        
        /* Content Sections */
        .content {
            display: none;
            margin: 2rem 0;
        }
        .content.active {
            display: block;
        }
        
        /* Instagram-like Post Card */
        .post-card {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            overflow: hidden;
            background: #fff;
            margin-bottom: 20px;
        }

        .image-wrap {
            position: relative;
            width: 100%;
            aspect-ratio: 4/5;
            overflow: hidden;
        }

        .post-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            /* Make image unclickable */
            pointer-events: none;
        }

        /* Header that covers the top part of the image */
        .image-header {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            background: #fff;
            display: flex;
            align-items: center;
            padding: 8px 12px;
            gap: 10px;
            box-sizing: border-box;
            border-bottom: 1px solid #ddd;
        }

        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
        }
        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            /* Make avatar image unclickable */
            pointer-events: none;
        }

        .username {
            font-weight: 600;
            font-size: 14px;
            color: #222;
        }

        .post-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 14px;
            border-top: 1px solid #eee;
            background: #fff;
        }

        .download-btn {
            background: #7b2cbf;
            color: #fff;
            border: none;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }
        
        /* Photo grid adjustments */
        .photos-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* ----------  REELS – UPDATED OVERLAY SYSTEM  ---------- */
        .reels-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 500px;
            margin: auto;
        }
        .reel-wrapper {
            position: relative;
            width: 100%;
            aspect-ratio: 9/16;
            background: #000;
            border-radius: var(--radius);
            overflow: hidden;
        }
        .reel-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            pointer-events: none;
        }
        .reel-overlay {
            position: absolute;
            inset: 0;
            z-index: 2;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 16px;
            pointer-events: none;
        }
        .reel-header {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .reel-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            overflow: hidden;
            flex-shrink: 0;
        }
        .reel-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            pointer-events: none;
        }
        .reel-user {
            color: #fff;
            font-weight: 600;
            font-size: 14px;
            text-shadow: 0 1px 3px rgba(0,0,0,.8);
        }
        .reel-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
            pointer-events: auto;
            align-items: flex-end;
        }
        .reel-action-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: rgba(0,0,0,.45);
            color: #fff;
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            font-size: 11px;
            font-weight: 600;
        }
        .reel-action-btn svg {
            width: 24px;
            height: 24px;
            margin-bottom: 2px;
        }
        .reel-like.liked svg {
            fill: #ff5252;
        }
        .reel-stat {
            font-size: 11px;
            margin-top: 2px;
            text-align: center;
        }
        
        /* Exclusive Content */
        .exclusive-content {
            padding: 20px;
            text-align: center;
            color: #8e8e8e;
        }
        .exclusive-content img {
            /* Make exclusive content images unclickable */
            pointer-events: none;
        }

        /* Viewer Modals */
        .viewer-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            z-index: 1000;
            flex-direction: column;
        }
        .viewer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: 10;
            background: linear-gradient(to bottom, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0) 100%);
        }
        .viewer-username {
            font-size: 16px;
            font-weight: 600;
            color: white;
        }
        .close-viewer {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: white;
        }
        .feed {
            flex: 1;
            overflow-y: auto;
            scroll-snap-type: y mandatory;
        }
        .post-view {
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            scroll-snap-align: start;
            position: relative;
        }
        .post-media {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .post-actions {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            }
        .post-actions.overlay {
            position: absolute;
            bottom: 20px;
            right: 20px;
            flex-direction: column;
            gap: 10px;
            margin-top: 0;
        }
        .like-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 24px;
            color: white;
            background: rgba(0, 0, 0, 0.5);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .like-btn.liked {
            color: #ed4956;
        }
        .donate-btn {
            padding: 10px 20px;
            background-color: #0095f6;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
        }
        
        /* Username Overlay */
        .media-username {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-weight: 600;
            font-size: 16px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.8);
            z-index: 5;
            background: rgba(0, 0, 0, 0.4);
            padding: 8px 15px;
            border-radius: 20px;
        }

        footer { 
            text-align: center; 
            margin: 2rem 0; 
            color: var(--muted); 
            font-size: .9rem; 
        }

        /* Chat - Updated for fixed header and footer */
        .chat-screen { 
            display: none; 
            flex-direction: column; 
            height: 100vh; 
            background: #fff; 
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
        }
        .chat-header { 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: .6rem 1rem; 
            border-bottom: 1px solid #e5e7eb; 
            background: #fff; 
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 10; 
            height: 60px;
        }
        .chat-header-left { 
            display: flex; 
            align-items: center; 
            gap: .6rem; 
            flex: 1;
        }
        .chat-header-left img { 
            width: 40px; 
            height: 40px; 
            border-radius: 50%; 
            object-fit: cover; 
        }
        .chat-user-info { 
            display: flex; 
            flex-direction: column; 
            line-height: 1.2; 
        }
        .chat-user-info strong { 
            font-size: .95rem; 
        }
        .online { 
            font-size: .75rem; 
            color: green; 
        }
        .chat-header-right { 
            display: flex; 
            align-items: center; 
            gap: 1rem; 
        }
        .chat-header button { 
            background: none; 
            border: none; 
            font-size: 1.4rem; 
            cursor: pointer; 
            color: var(--fg); 
        }
        .chat-messages { 
            flex: 1; 
            overflow-y: auto; 
            padding: 1rem; 
            display: flex; 
            flex-direction: column; 
            gap: .5rem; 
            background: #f3f4f6; 
            margin-top: 60px; /* Height of chat header */
            margin-bottom: 70px; /* Height of chat input */
            height: calc(100vh - 130px); /* Viewport height minus header and input heights */
        }
        .msg-wrapper { 
            display: flex; 
            flex-direction: column; 
            align-items: flex-end; 
        }
        .msg { 
            max-width: 70%; 
            padding: .6rem .9rem; 
            border-radius: var(--radius); 
            line-height: 1.4; 
            font-size: .9rem; 
            word-wrap: break-word; 
        }
        .creator-msg { 
            background: #e5e7eb; 
            align-self: flex-start; 
        }
        .user-msg { 
            background: var(--accent); 
            color: white; 
        }
        .seen { 
            font-size: .7rem; 
            color: var(--muted); 
            margin-top: .2rem; 
            margin-right: .3rem; 
        }
        .typing { 
            font-size: .8rem; 
            color: var(--muted); 
            font-style: italic; 
            margin: .2rem 0; 
        }
        .chat-input { 
            display: flex; 
            align-items: center; 
            padding: .5rem; 
            border-top: 1px solid #e5e7eb; 
            background: white; 
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 10;
            height: 60px;
        }
        .chat-input input { 
            flex: 1; 
            padding: .8rem; 
            border: 1px solid #d1d5db; 
            border-radius: 20px; 
            outline: none; 
            font-size: 1rem; 
        }
        .chat-input button { 
            background: none; 
            border: none; 
            font-size: 1.4rem; 
            margin-left: .6rem; 
            cursor: pointer; 
            color: var(--accent); 
        }

        /* Subscription Modal */
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.6); 
            justify-content: center; 
            align-items: center; 
        }
        #subscriptionModal .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            text-align: center;
            width: 90%;
            max-width: 320px;
            position: relative;
        }
        #subscriptionModal .close {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        #subscriptionModal .close:hover,
        #subscriptionModal .close:focus {
            color: black;
        }
        .subscription-options {
            margin-bottom: 20px;
            text-align: left;
        }
        .option {
            margin: 12px 0;
            padding: 8px;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .option input {
            margin-right: 10px;
        }
        #subscriptionModal .subscribe-btn {
            padding: 10px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }

        /* Donation modals */
        .modal-content { 
            background: #fff; 
            padding: 20px; 
            border-radius: 12px; 
            max-width: 420px; 
            width: 90%; 
            text-align: center; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); 
            position: relative; 
        }
        .modal-content h3 { 
            margin: 0 0 1rem; 
            font-size: 1.3rem; 
        }
        .close-x-button { 
            position: absolute; 
            top: 10px; 
            right: 15px; 
            font-size: 20px; 
            cursor: pointer; 
            background: none; 
            border: none; 
        }
        .modal-button { 
            padding: .8rem 1.4rem; 
            margin: .6rem; 
            border: none; 
            border-radius: 20px; 
            cursor: pointer; 
            font-size: 1.1rem; 
            font-weight: 600; 
            color: white; 
        }
        .btc-button { 
            background: linear-gradient(45deg, #f7931a, #ffbf00); 
        }
        .paypal-button { 
            background: #0070ba; 
        }
        .back-button { 
            background: #f7931a; 
            color: white; 
            border: none; 
            border-radius: 20px; 
            padding: .8rem 1.4rem; 
            margin-top: .6rem; 
            cursor: pointer; 
            font-size: 1.1rem; 
        }
        .qr-code { 
            border: 2px solid #f7931a; 
            border-radius: 10px; 
            padding: 8px; 
            margin: 10px auto; 
            background: white; 
            width: 100%; 
            max-width: 200px; 
            display: block; 
        }
        .wallet-address-container { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            margin: 10px 0; 
            flex-wrap: wrap; 
            gap: 8px; 
        }
        .wallet-address { 
            word-break: break-all; 
            font-family: monospace; 
            font-size: 13px; 
            color: #444; 
            padding: 8px 10px; 
            background: #f1f1f1; 
            border-radius: 5px; 
            flex: 1; 
            text-align: center; 
        }
        .copy-button { 
            background: #28a745; 
            color: white; 
            padding: .8rem 1.4rem; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 1.1rem; 
        }
        .copy-button:hover { 
            background: #218838; 
        }
        .status-message { 
            font-size: 14px; 
            margin-top: 10px; 
            display: none; 
        }
        .status-success { 
            color: #28a745; 
        }
        .status-error { 
            color: #dc3545; 
        }
        .donate-button { 
            background: linear-gradient(45deg, #f7931a, #ffbf00); 
            color: white; 
            padding: .8rem 1.4rem; 
            border: none; 
            border-radius: 25px; 
            cursor: pointer; 
            font-size: 1.1rem; 
            font-weight: bold; 
            margin-top: .6rem; 
            box-shadow: 0 4px 8px rgba(247, 147, 26, 0.3); 
        }

        /* Story modal */
        .story-modal { 
            display: none; 
            position: fixed; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.95); 
            z-index: 2000; 
            justify-content: center; 
            align-items: center; 
        }
        .story-container { 
            position: relative; 
            width: 100%; 
            height: 100%; 
            max-width: 420px; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            overflow: hidden; 
            border-radius: 12px; 
            background: #000; 
        }
        .story-image { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            display: none; 
        }
        .story-image.active { 
            display: block; 
        }

        /* Story Header Styles */
        .story-header {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            z-index: 70;
            display: flex;
            align-items: center;
            justify-content: flex-start;
        }
        .story-user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .story-profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #fff;
        }
        .story-user-details {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .story-username {
            color: #fff;
            font-weight: 600;
            font-size: 16px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }
        .story-verified {
            color: #1DA1F2;
            font-size: 16px;
            font-weight: bold;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }
        .progress-bars { 
            position: absolute; 
            top: 80px; 
            left: 10px; 
            right: 10px; 
            height: 3px; 
            display: flex; 
            gap: 6px; 
            z-index: 50; 
        }
        .progress-bar { 
            flex: 1; 
            height: 100%; 
            background: rgba(255,255,255,0.25); 
            border-radius: 2px; 
            overflow: hidden; 
        }
        .progress-bar-fill { 
            height: 100%; 
            background: #fff; 
            width: 0%; 
        }
        .story-count { 
            position: absolute; 
            top: 84px; 
            left: 14px; 
            color: #fff; 
            font-size: 12px; 
            background: rgba(0,0,0,0.45); 
            padding: 6px 8px; 
            border-radius: 12px; 
            z-index: 60; 
        }
        .btn { 
            background: transparent; 
            border: 0; 
            width: 64px; 
            height: 64px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            z-index: 60; 
            font-size: 28px; 
        }
        .close-btn { 
            position: absolute; 
            top: 24px; 
            right: 24px; 
            width: 28px; 
            height: 28px; 
            font-size: 18px; 
            line-height: 28px; 
            text-align: center; 
            background: rgba(0,0,0,0.6); 
            borderRadius: 50%; 
            color: #fff; 
            z-index: 75; 
        }
        .nav-btn { 
            position: absolute; 
            top: 50%; 
            transform: translateY(-50%); 
            background: rgba(0,0,0,0.6); 
            borderRadius: 50%; 
            display: none; 
            align-items: center; 
            justify-content: center; 
            z-index: 60; 
            color: #fff; 
        }
        .nav-btn.visible { 
            display: flex; 
        }
        .nav-btn-left { 
            left: 14px; 
        }
        .nav-btn-right { 
            right: 14px; 
        }
        .story-controls { 
            position: absolute; 
            bottom: 28px; 
            left: 50%; 
            transform: translateX(-50%); 
            display: flex; 
            gap: 14px; 
            width: 92%; 
            align-items: center; 
            z-index: 60; 
        }
        .reply-input { 
            flex: 1; 
            background: rgba(255,255,255,0.12); 
            border: 1px solid rgba(255,255,255,0.15); 
            border-radius: 22px; 
            padding: 14px 18px; 
            color: #fff; 
            outline: none; 
            font-size: 1rem; 
        }
        .reply-input::placeholder { 
            color: rgba(255,255,255,0.7); 
        }
        .send-btn { 
            display: none; 
            background: rgba(0,0,0,0.5); 
            border: 0; 
            color: #fff; 
            width: 56px; 
            height: 56px; 
            border-radius: 50%; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            font-size: 24px; 
        }
        .send-btn.visible { 
            display: flex; 
        }
        .like-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff416c, #ff4b2b);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 24px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            transition: transform 0.2s;
            z-index: 75;
        }
        .like-btn:hover {
            transform: scale(1.1);
        }
        .like-btn.liked {
            background: linear-gradient(45deg, #fa709a, #fee140);
        }

        /* New styles for SVG icons and interactive buttons */
        .post-stats {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .stat-btn {
            display: flex;
            align-items: center;
            gap: 5px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            color: #555;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.2s ease;
        }
        .stat-btn:hover {
            background-color: #f0f0f0;
        }
        .stat-btn.liked {
            color: #ed4956;
        }
        .stat-btn .icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .stat-btn .count {
            font-weight: 600;
        }
        
        /* SVG icon styles */
        .svg-icon {
            width: 1em;
            height: 1em;
            display: inline-block;
            vertical-align: middle;
            fill: currentColor;
        }

        /* Comment Modal Styles */
        .comment-modal {
            background: white;
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.4s ease;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
        }
        
        .modal-overlay.active .comment-modal {
            transform: scale(1);
            opacity: 1;
        }
        
        .modal-header {
            background: #f8f9fa;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: #6b7280;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .close-btn:hover {
            transform: rotate(90deg);
            color: #374151;
        }
        
        .modal-body {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
        }
        
        .comment {
            background: #f9fafb;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .comment-author {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #374151;
            font-size: 0.9rem;
        }
        
        .comment-time {
            font-size: 0.8rem;
            color: #6b7280;
        }
        
        .comment-text {
            line-height: 1.5;
            color: 4b5563;
        }
        
        .modal-footer {
            padding: 20px;
            background: #f8f9fa;
            border-top: 1px solid #e5e7eb;
        }
        
        .comment-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .form-group label {
            font-size: 0.9rem;
            color: #374151;
        }
        
        .form-group input,
        .form-group textarea {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            background: white;
            color: #374151;
            font-size: 1rem;
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .submit-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .submit-btn:hover {
            background: #1d4ed8;
        }
        
        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body>
    <!-- Header with Hamburger Menu - FIXED -->
    <div class="header">
        <div class="title">Sofia Creator</div>
        <div class="hamburger" onclick="toggleMenu()">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    
    <!-- Compact Navigation Menu -->
    <nav class="menu">
        <ul>
            <li><a href="#" onclick="switchTab('photos')">Home</a></li>
            <li><a href="#" onclick="switchTab('chat')">Chat</a></li>
            <li><a href="#" onclick="switchTab('support')">Support</a></li>
            <li><a href="#" onclick="switchTab('about')">About</a></li>
            <li><a href="#" onclick="toggleMenu()">Close</a></li>
        </ul>
    </nav>

    <div class="container main-screen">
        <section class="profile">
            <div class="profile-pic-wrapper has-story">
                <img id="profilePic" class="profile-pic" src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=200&q=80" alt="Creator profile picture">
            </div>
            <div class="creator-name">Sofia Creator <span class="verified">
                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="1em" height="1em" viewBox="0 0 48 48">
                    <polygon fill="#42a5f5" points="29.62,3 33.053,8.308 39.367,8.624 39.686,14.937 44.997,18.367 42.116,23.995 45,29.62 39.692,33.053 39.376,39.367 33.063,39.686 29.633,44.997 24.005,42.116 18.38,45 14.947,39.692 8.633,39.376 8.314,33.063 3.003,29.633 5.884,24.005 3,18.38 8.308,14.947 8.624,8.633 14.937,8.314 18.367,3.003 23.995,5.884"></polygon>
                    <polygon fill="#fff" points="21.396,31.255 14.899,24.76 17.021,22.639 21.428,27.046 30.996,17.772 33.084,19.926"></polygon>
                </svg>
            </span></div>
            <div class="username">@sofia123</div>
            <div class="stats">
                <div class="stat"><strong>15.2k</strong> Followers</div>
                <div class="stat"><strong>320k</strong> Likes</div>
            </div>
            <div class="actions">
                <button class="subscribe" onclick="openSubscribeModal()">Subscribe</button>
                <button class="message" id="openChat">Message</button>
                <button class="donate" id="openDonate">Donate</button>
            </div>
        </section>

        <div class="tabs">
            <button class="tab-btn active" data-tab="photos">Photos</button>
            <button class="tab-btn" data-tab="reels">Reels</button>
            <button class="tab-btn" data-tab="exclusive">Exclusive</button>
        </div>
        
        <!-- Photos Content -->
        <div id="photos-content" class="content active">
            <div class="photos-grid" id="photosGrid">
                <!-- Photos will be inserted here by JavaScript -->
            </div>
        </div>
        
        <!-- Reels Content - Updated with new system -->
        <div id="reels-content" class="content">
            <div class="reels-grid" id="reelsGrid"></div>
        </div>
        
        <!-- Exclusive Content -->
        <div id="exclusive-content" class="content">
            <div class="exclusive-content">
                <p>Subscribe to unlock exclusive content 
                    <svg class="svg-icon" viewBox="0 0 24 24" style="width: 16px; height: 16px;">
                        <path d="M9.5 14c0 .4.1.8.3 1.1.2.3.5.6.9.8.4.2.8.3 1.3.3s.9-.1 1.3-.3c.4-.2.7-.5.9-.8.2-.3.3-.7.3-1.1s-.1-.8-.3-1.1c-.2-.3-.5-.6-.9-.8-.4-.2-.8-.3-1.3-.3s-.9.1-1.3.3c-.4.2-.7.5-.9.8-.2.3-.3.7-.3 1.1zm4.9-1.9c.4.4.6.9.8 1.5.2.6.3 1.2.3 1.9s-.1 1.3-.3 1.9c-.2.6-.5 1.1-.8 1.5-.4.4-.8.8-1.4 1-.6.3-1.2.4-1.9.4s-1.3-.1-1.9-.4c-.6-.3-1-.6-1.4-1-.4-.4-.6-.9-.8-1.5-.2-.6-.3-1.2-.3-1.9s.1-1.3.3-1.9c.2-.6.5-1.1.8-1.5.4-.4.8-.8 1.4-1 .6-.3 1.2-.4 1.9-.4s1.3.1 1.9.4c.6.3 1 .6 1.4 1zM12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8z"/>
                    </svg>
                </p>
                <div class="media-grid">
                    <img src="https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80" alt="Exclusive content locked">
                </div>
            </div>
        </div>
        
        <footer>&copy; <span id="year"></span> Sofia Creator</footer>
    </div>

    <!-- Photo Viewer Modal -->
    <div class="viewer-modal" id="photoViewerModal">
        <div class="viewer-header">
            <button class="close-viewer" onclick="closePhotoViewer()">
                <svg class="svg-icon" viewBox="0 0 24 24" width="24" height="24" fill="#fff">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
        </div>
        <div class="feed" id="photoFeed"></div>
    </div>

    <!-- Reel Viewer Modal - Updated with new system -->
    <div class="viewer-modal" id="reelViewerModal">
        <div class="viewer-header">
            <button class="close-viewer" onclick="closeReelViewer()">
                <svg class="svg-icon" viewBox="0 0 24 24" width="24" height="24" fill="#fff">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
        </div>
        <div class="feed" id="reelFeed"></div>
    </div>

    <div id="chatScreen" class="chat-screen container">
        <div class="chat-header">
            <div class="chat-header-left">
                <button class="btn" id="backToMain">
                    <svg class="svg-icon" viewBox="0 0 24 24" width="20" height="20">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </button>
                <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=200&q=80" alt="Creator">
                <div class="chat-user-info">
                    <strong>Sofia Creator</strong>
                    <span class="online">Online</span>
                </div>
            </div>
            <div class="chat-header-right">
                <button title="Video Call">
                    <svg class="svg-icon" viewBox="0 0 24 24" width="20" height="20">
                        <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
                    </svg>
                </button>
                <button title="Voice Call">
                    <svg class="svg-icon" viewBox="0 0 24 24" width="20" height="20">
                        <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                    </svg>
                </button>
            </div>
        </div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
            <input id="chatInput" placeholder="Message...">
            <button id="sendMessage">
                <svg class="svg-icon" viewBox="0 0 24 24" width="20" height="20">
                    <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Subscription Modal -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSubscribeModal()">
                <svg class="svg-icon" viewBox="0 0 24 24" width="20" height="20">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </span>
            <h2>Choose Your Subscription Plan</h2>
            <div class="subscription-options">
                <div class="option">
                    <input type="radio" id="basic" name="plan" value="basic" checked>
                    <label for="basic">Basic Plan - $4.99/month (Ad-supported access)</label>
                </div>
                <div class="option">
                    <input type="radio" id="premium" name="plan" value="premium">
                    <label for="premium">Premium Plan - $9.99/month (Ad-free, exclusive content)</label>
                </div>
                <div class="option">
                    <input type="radio" id="ultimate" name="plan" value="ultimate">
                    <label for="ultimate">Ultimate Plan - $19.99/month (Ad-free, exclusive content, early access, merchandise discounts)</label>
                </div>
            </div>
            <button class="subscribe-btn" onclick="subscribe()">Subscribe Now</button>
        </div>
    </div>

    <div id="chooseMethodModal" class="modal">
        <div class="modal-content">
            <button class="close-x-button" id="closeDonate">
                <svg class="svg-icon" viewBox="0 0 24 24" width="20" height="20">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
            <h3>Choose Your Donation Method</h3>
            <div class="modal-buttons-container">
                <button class="modal-button btc-button" id="openBtcDonate">Donate with Bitcoin</button>
                <form action="https://www.paypal.com/donate" method="post" target="_blank" style="display:inline;">
                    <input type="hidden" name="business" value="YOUR_PAYPAL_EMAIL@EXAMPLE.COM"/>
                    <input type="hidden" name="currency_code" value="USD"/>
                    <input type="submit" class="modal-button paypal-button" value="Donate with PayPal"/>
                </form>
            </div>
        </div>
    </div>

    <div id="btcDonateModal" class="modal">
        <div class="modal-content">
            <button class="close-x-button" id="closeBtcDonate">
                <svg class="svg-icon" viewBox="0 0 24 24" width="20" height="20">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
            <h3>Support Us with Bitcoin! 
                <svg class="svg-icon" viewBox="0 0 24 24" width="20" height="20" style="vertical-align: middle;">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.22-13.5h-2.5v3.5H7.5v2h2.22v3H7.5v2h4.72v-10zm4.78 8.5h-2.5v-10h2.5v10z"/>
                </svg>
            </h3>
            <img id="qrCode" src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=bc1q0ehvhyeaqnzj7apuk0a6d4ureayfl038cs8r6n" alt="BTC QR Code" class="qr-code">
            <p>Scan the QR code or copy the address below:</p>
            <div class="wallet-address-container">
                <div class="wallet-address" id="btcAddress">bc1q0ehvhyeaqnzj7apuk0a6d4ureayfl038cs8r6n</div>
                <button class="copy-button" id="copyBtcAddress">Copy</button>
            </div>
            <div id="statusMessage" class="status-message"></div>
            <button class="donate-button" id="donateBtcNow">Donate BTC Now</button>
            <button class="back-button" id="backToDonate">Back</button>
        </div>
    </div>

    <!-- Comment Modal -->
    <div class="modal-overlay" id="commentModalOverlay" onclick="closeCommentModal(event)">
        <div class="comment-modal">
            <div class="modal-header">
                <h2 class="modal-title">Comments</h2>
                <button class="close-btn" onclick="closeCommentModal(event)">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            
            <div class="modal-body" id="commentModalBody">
                <!-- Comments will be loaded here -->
            </div>
            
            <div class="modal-footer">
                <form class="comment-form" onsubmit="addComment(event)">
                    <div class="form-group">
                        <label for="commentName">Name</label>
                        <input type="text" id="commentName" required>
                    </div>
                    <div class="form-group">
                        <label for="commentText">Your Comment</label>
                        <textarea id="commentText" required></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Post Comment</button>
                </form>
            </div>
        </div>
    </div>

    <div id="storyModal" class="story-modal">
        <div class="story-container" id="storyContainer">
            <!-- Story Header with Profile Picture, Username, and Verified Badge -->
            <div class="story-header">
                <div class="story-user-info">
                    <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=200&q=80" alt="Profile" class="story-profile-pic">
                    <div class="story-user-details">
                        <span class="story-username">Sofia Creator</span>
                        <span class="story-verified">
                            <svg class="svg-icon" viewBox="0 0 24 24" width="16" height="16" fill="#1DA1F2">
                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                            </svg>
                        </span>
                    </div>
                </div>
            </div>

            <div id="progressBars" class="progress-bars"></div>
            <div id="storyCount" class="story-count"></div>

            <!-- Story images -->
            <img src="https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" class="story-image active" data-index="0" alt="Story 1">
            <img src="https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" class="story-image" data-index="1" alt="Story 2">
            <img src="https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" class="story-image" data-index="2" alt="Story 3">

            <!-- Smaller close button -->
            <button class="btn close-btn" id="storyCloseBtn">
                <svg class="svg-icon" viewBox="0 0 24 24" width="16" height="16" fill="#fff">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>

            <!-- Navigation -->
            <button class="btn nav-btn nav-btn-left" id="prevStoryBtn">
                <svg class="svg-icon" viewBox="0 0 24 24" width="24" height="24" fill="#fff">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                </svg>
            </button>
            <button class="btn nav-btn nav-btn-right" id="nextStoryBtn">
                <svg class="svg-icon" viewBox="0 0 24 24" width="24" height="24" fill="#fff">
                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                </svg>
            </button>

            <!-- Controls -->
            <div class="story-controls">
                <input id="replyInput" class="reply-input" placeholder="Reply to this story">
                <button id="sendStoryBtn" class="send-btn">
                    <svg class="svg-icon" viewBox="0 0 24 24" width="20" height="20" fill="#fff">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                    </svg>
                </button>
                <button id="likeStoryBtn" class="btn like-btn">
                    <svg class="svg-icon" viewBox="0 0 24 24" width="20" height="20" fill="#fff">
                        <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        document.getElementById("year").textContent = new Date().getFullYear();

        // SVG icons for like, comment, and donate
        const heartIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
        </svg>`;
        
        const commentIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>`;
        
        const giftIcon = `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 12 20 22 4 22 4 12"></polyline>
            <rect x="2" y="7" width="20" height="5"></rect>
            <line x1="12" y1="22" x2="12" y2="7"></line>
            <path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path>
            <path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path>
        </svg>`;

        // Photo and Reel Data
        const photos = [
            { 
                id: 1, 
                url: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80',
                likes: 124,
                comments: 32
            },
            { 
                id: 2, 
                url: 'https://images.unsplash.com/photo-1492681290082-e932832941e6?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80',
                likes: 89,
                comments: 21
            },
            { 
                id: 3, 
                url: 'https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80',
                likes: 156,
                comments: 43
            },
            { 
                id: 4, 
                url: 'https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80',
                likes: 201,
                comments: 56
            },
            { 
                id: 5, 
                url: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80',
                likes: 167,
                comments: 38
            },
            { 
                id: 6, 
                url: 'https://images.unsplash.com/photo-1519699047748-de8e457a634e?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80',
                likes: 142,
                comments: 29
            },
        ];

        const reels = [
            { 
                id: 1, 
                thumbnail: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80', 
                url: 'https://assets.mixkit.co/videos/preview/mixkit-girl-in-neon-sign-1232-large.mp4',
                likes: 215,
                comments: 47
            },
            { 
                id: 2, 
                thumbnail: 'https://images.unsplash.com/photo-1492681290082-e932832941e6?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80', 
                url: 'https://assets.mixkit.co/videos/preview/mixkit-tree-with-yellow-flowers-1173-large.mp4',
                likes: 178,
                comments: 32
            },
            { 
                id: 3, 
                thumbnail: 'https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80', 
                url: 'https://assets.mixkit.co/videos/preview/mixkit-a-girl-blowing-a-bubble-gum-at-an-amusement-park-1226-large.mp4',
                likes: 243,
                comments: 61
            },
            { 
                id: 4, 
                thumbnail: 'https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80', 
                url: 'https://assets.mixkit.co/videos/preview/mixkit-girl-in-neon-sign-1232-large.mp4',
                likes: 192,
                comments: 41
            },
            { 
                id: 5, 
                thumbnail: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80', 
                url: 'https://assets.mixkit.co/videos/preview/mixkit-tree-with-yellow-flowers-1173-large.mp4',
                likes: 165,
                comments: 28
            },
            { 
                id: 6, 
                thumbnail: 'https://images.unsplash.com/photo-1519699047748-de8e457a634e?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80', 
                url: 'https://assets.mixkit.co/videos/preview/mixkit-a-girl-blowing-a-bubble-gum-at-an-amusement-park-1226-large.mp4',
                likes: 203,
                comments: 52
            },
        ];

        // Comments data for each media item
        const commentsData = {
            photo_1: [
                { author: "John Doe", text: "This is absolutely stunning! The colors are so vibrant and the composition is perfect.", time: "2 hours ago" },
                { author: "Sarah Smith", text: "I've been to this location and the photo doesn't even do it justice! Amazing work capturing the essence.", time: "5 hours ago" },
                { author: "Alex Johnson", text: "What camera settings did you use for this shot? The lighting is perfect!", time: "1 day ago" }
            ],
            photo_2: [
                { author: "Mike Wilson", text: "Beautiful scenery! I love how the light hits the mountains.", time: "3 hours ago" },
                { author: "Emma Thompson", text: "This takes my breath away. Great work!", time: "1 day ago" }
            ],
            // Add more comments for other photos and reels as needed
            reel_1: [
                { author: "David Brown", text: "This is so creative! Love the editing.", time: "4 hours ago" },
                { author: "Sophia Garcia", text: "The transitions are so smooth. How did you achieve this effect?", time: "1 day ago" }
            ]
        };

        // Initialize photo grid with Instagram-style post cards
        const photosGrid = document.getElementById('photosGrid');
        photos.forEach(photo => {
            const postCard = createPostCard(photo, 'photo');
            photosGrid.appendChild(postCard);
        });

        // Initialize reels with new overlay system
        buildReels();

        // Function to create Instagram-style post card (for photos only)
        function createPostCard(item, type) {
            const postCard = document.createElement('div');
            postCard.className = 'post-card';
            
            // Image container
            const imageWrap = document.createElement('div');
            imageWrap.className = 'image-wrap';
            
            // Main image
            const img = document.createElement('img');
            img.className = 'post-image';
            img.src = item.url;
            img.alt = `Photo ${item.id}`;
            img.setAttribute('crossorigin', 'anonymous');
            img.setAttribute('data-image', item.url);
            
            // Header with profile info
            const imageHeader = document.createElement('div');
            imageHeader.className = 'image-header';
            
            const avatar = document.createElement('div');
            avatar.className = 'avatar';
            
            const avatarImg = document.createElement('img');
            avatarImg.src = 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=200&q=80';
            avatarImg.alt = 'Profile avatar';
            
            avatar.appendChild(avatarImg);
            
            const username = document.createElement('div');
            username.className = 'username';
            username.textContent = '@sofia123';
            
            imageHeader.appendChild(avatar);
            imageHeader.appendChild(username);
            
            imageWrap.appendChild(img);
            imageWrap.appendChild(imageHeader);
            
            // Footer with stats and download button
            const postFooter = document.createElement('div');
            postFooter.className = 'post-footer';
            
            // Create stats container with SVG buttons
            const stats = document.createElement('div');
            stats.className = 'post-stats';
            
            // Like button with SVG
            const likeBtn = document.createElement('button');
            likeBtn.className = 'stat-btn';
            likeBtn.innerHTML = `${heartIcon} <span class="count">${item.likes}</span>`;
            likeBtn.onclick = (e) => {
                e.stopPropagation();
                likeBtn.classList.toggle('liked');
                const countSpan = likeBtn.querySelector('.count');
                if (likeBtn.classList.contains('liked')) {
                    countSpan.textContent = parseInt(countSpan.textContent) + 1;
                    // Update the SVG to filled heart
                    likeBtn.innerHTML = `<svg class="icon" viewBox="0 0 24 24" fill="#ed4956" stroke="#ed4956" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg> <span class="count">${countSpan.textContent}</span>`;
                } else {
                    countSpan.textContent = parseInt(countSpan.textContent) - 1;
                    // Revert to outline heart
                    likeBtn.innerHTML = `${heartIcon} <span class="count">${countSpan.textContent}</span>`;
                }
            };
            
            // Comment button with SVG - updated to open comment modal
            const commentBtn = document.createElement('button');
            commentBtn.className = 'stat-btn';
            commentBtn.innerHTML = `${commentIcon} <span class="count">${item.comments}</span>`;
            commentBtn.onclick = (e) => {
                e.stopPropagation();
                openCommentModal(`${type}_${item.id}`);
            };
            
            // Donate button with SVG
            const donateBtn = document.createElement('button');
            donateBtn.className = 'stat-btn';
            donateBtn.innerHTML = `${giftIcon} Donate`;
            donateBtn.onclick = (e) => {
                e.stopPropagation();
                document.getElementById('openDonate').click();
            };
            
            stats.appendChild(likeBtn);
            stats.appendChild(commentBtn);
            stats.appendChild(donateBtn);
            
            const downloadBtn = document.createElement('button');
            downloadBtn.className = 'download-btn';
            downloadBtn.textContent = 'Download';
            downloadBtn.addEventListener('click', async (e) => {
                e.stopPropagation(); // Prevent opening the viewer
                const src = img.getAttribute('data-image') || img.src;
                try {
                    const res = await fetch(src, {mode:'cors'});
                    const blob = await res.blob();
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `photo-${item.id}.jpg`;
                    document.body.appendChild(a);
                    a.click();
                    a.remove();
                    URL.revokeObjectURL(url);
                } catch {
                    window.open(src, '_blank');
                }
            });
            
            postFooter.appendChild(stats);
            postFooter.appendChild(downloadBtn);
            
            postCard.appendChild(imageWrap);
            postCard.appendChild(postFooter);
            
            // Add click event to open viewer - but not on the image itself
            postCard.addEventListener('click', (e) => {
                // Don't open viewer if clicking on image, download button, or stat buttons
                if (e.target === img || e.target === downloadBtn || e.target.closest('.stat-btn')) {
                    return;
                }
                openPhotoViewer(item.id);
            });
            
            return postCard;
        }

        /* ----------  REELS – UPDATED OVERLAY SYSTEM  ---------- */
        function buildReels() {
            const grid = document.getElementById('reelsGrid');
            reels.forEach(r => {
                const wrap = document.createElement('div');
                wrap.className = 'reel-wrapper';
                
                const video = document.createElement('video');
                video.className = 'reel-video';
                video.src = r.url;
                video.loop = true;
                video.poster = r.thumbnail;
                video.playsinline = true;
                video.muted = true;
                
                const overlay = document.createElement('div');
                overlay.className = 'reel-overlay';
                
                // Header with username at the top
                const header = document.createElement('div');
                header.className = 'reel-header';
                
                const avatar = document.createElement('div');
                avatar.className = 'reel-avatar';
                
                const avatarImg = document.createElement('img');
                avatarImg.src = 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=200&q=80';
                avatarImg.alt = 'Profile avatar';
                
                avatar.appendChild(avatarImg);
                
                const user = document.createElement('div');
                user.className = 'reel-user';
                user.textContent = '@sofia123';
                
                header.appendChild(avatar);
                header.appendChild(user);
                
                // Actions container at the bottom
                const acts = document.createElement('div');
                acts.className = 'reel-actions';
                
                // Like button
                const like = document.createElement('button');
                like.className = 'reel-action-btn reel-like';
                like.innerHTML = `
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    <span class="reel-stat">${r.likes}</span>
                `;
                
                // Comment button (updated to open comment modal)
                const comment = document.createElement('button');
                comment.className = 'reel-action-btn';
                comment.innerHTML = `
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span class="reel-stat">${r.comments}</span>
                `;
                comment.onclick = e => {
                    e.stopPropagation();
                    openCommentModal(`reel_${r.id}`);
                };
                
                // Donate button with USD icon (updated)
                const donate = document.createElement('button');
                donate.className = 'reel-action-btn';
                donate.innerHTML = `
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2v20m-5.5-6.5c0-1.3 2-2.5 5.5-2.5s5.5 1.2 5.5 2.5M12 6c-3.3 0-6-1.3-6-3s2.7-3 6-3 6 1.3 6 3-2.7 3-6 3z"/>
                    </svg>
                    <span class="reel-stat">Donate</span>
                `;
                
                like.onclick = e => {
                    e.stopPropagation();
                    like.classList.toggle('liked');
                    if (like.classList.contains('liked')) {
                        const stat = like.querySelector('.reel-stat');
                        stat.textContent = parseInt(stat.textContent) + 1;
                    } else {
                        const stat = like.querySelector('.reel-stat');
                        stat.textContent = parseInt(stat.textContent) - 1;
                    }
                };
                
                donate.onclick = e => {
                    e.stopPropagation();
                    document.getElementById('openDonate').click();
                };
                
                acts.append(like, comment, donate);
                overlay.append(header, acts);
                wrap.append(video, overlay);
                grid.append(wrap);

                let hideTmr;
                const showOverlay = () => {
                    overlay.style.opacity = 1;
                    clearTimeout(hideTmr);
                    hideTmr = setTimeout(() => overlay.style.opacity = 0, 2000);
                };
                
                wrap.addEventListener('click', () => {
                    if (video.paused) {
                        video.play();
                        showOverlay();
                    } else {
                        video.pause();
                        overlay.style.opacity = 1;
                    }
                });
                
                video.addEventListener('play', showOverlay);
                video.addEventListener('pause', () => overlay.style.opacity = 1);
                
                // Add double click to open full viewer
                wrap.addEventListener('dblclick', (e) => {
                    if (e.target === video) return;
                    openReelViewer(r.id);
                });
            });
        }

        // Photo Viewer Functions
        function openPhotoViewer(id) {
            const modal = document.getElementById('photoViewerModal');
            const feed = document.getElementById('photoFeed');
            feed.innerHTML = '';
            photos.forEach(photo => {
                const view = document.createElement('div');
                view.className = 'post-view';
                
                // Add username overlay
                const usernameOverlay = document.createElement('div');
                usernameOverlay.className = 'media-username';
                usernameOverlay.textContent = '@sofia123';
                view.appendChild(usernameOverlay);
                
                const img = document.createElement('img');
                img.className = 'post-media';
                img.src = photo.url;
                img.onload = () => {
                    img.style.width = 'auto';
                    img.style.height = 'auto';
                };
                view.appendChild(img);
                const actions = document.createElement('div');
                actions.className = 'post-actions';
                const likeBtn = document.createElement('button');
                likeBtn.className = 'like-btn';
                likeBtn.innerHTML = '<svg class="svg-icon" viewBox="0 0 24 24" width="24" height="24" fill="#fff"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z"/></svg>';
                likeBtn.onclick = (e) => {
                    e.stopPropagation();
                    likeBtn.classList.toggle('liked');
                };
                const donateBtn = document.createElement('button');
                donateBtn.className = 'donate-btn';
                donateBtn.textContent = 'Donate';
                donateBtn.onclick = (e) => {
                    e.stopPropagation();
                    document.getElementById('openDonate').click();
                };
                actions.appendChild(likeBtn);
                actions.appendChild(donateBtn);
                view.appendChild(actions);
                feed.appendChild(view);
            });
            modal.style.display = 'flex';
            feed.scrollTo(0, (id - 1) * window.innerHeight);
        }

        function closePhotoViewer() {
            document.getElementById('photoViewerModal').style.display = 'none';
        }

        /* ----------  REELS VIEWER  ---------- */
        function openReelViewer(id) {
            const modal = document.getElementById('reelViewerModal');
            modal.style.display = 'flex';
            
            const feed = document.getElementById('reelFeed');
            feed.innerHTML = '';
            
            reels.forEach(r => {
                const v = document.createElement('div');
                v.className = 'post-view';
                
                const u = document.createElement('div');
                u.className = 'media-username';
                u.textContent = '@sofia123';
                
                const wrap = document.createElement('div');
                wrap.className = 'media-wrap';
                
                const video = document.createElement('video');
                video.className = 'post-media';
                video.src = r.url;
                video.controls = true;
                video.autoplay = true;
                video.loop = true;
                
                const acts = document.createElement('div');
                acts.className = 'post-actions overlay';
                
                const like = document.createElement('button');
                like.className = 'like-btn';
                like.innerHTML = '<svg class="svg-icon" viewBox="0 0 24 24" width="24" height="24" fill="#fff"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z"/></svg>';
                
                const don = document.createElement('button');
                don.className = 'donate-btn';
                don.textContent = 'Donate';
                
                like.onclick = () => like.classList.toggle('liked');
                don.onclick = () => document.getElementById('openDonate').click();
                
                acts.append(like, don);
                wrap.append(video, acts);
                v.append(u, wrap);
                feed.append(v);
            });
            
            feed.scrollTo(0, (id - 1) * window.innerHeight);
        }

        function closeReelViewer() {
            document.getElementById('reelViewerModal').style.display = 'none';
        }

        // New functions for menu and subscription modal
        function toggleMenu() {
            const menu = document.querySelector('.menu');
            const hamburger = document.querySelector('.hamburger');
            menu.classList.toggle('active');
            hamburger.classList.toggle('active');
            
            // Close menu when clicking outside
            if (menu.classList.contains('active')) {
                document.addEventListener('click', closeMenuOnClickOutside);
            } else {
                document.removeEventListener('click', closeMenuOnClickOutside);
            }
        }

        function closeMenuOnClickOutside(event) {
            const menu = document.querySelector('.menu');
            const hamburger = document.querySelector('.hamburger');
            
            if (!menu.contains(event.target) && !hamburger.contains(event.target)) {
                menu.classList.remove('active');
                hamburger.classList.remove('active');
                document.removeEventListener('click', closeMenuOnClickOutside);
            }
        }

        function openSubscribeModal() {
            document.getElementById('subscriptionModal').style.display = 'flex';
        }

        function closeSubscribeModal() {
            document.getElementById('subscriptionModal').style.display = 'none';
        }

        function subscribe() {
            const selectedPlan = document.querySelector('input[name="plan"]:checked').value;
            alert(`You have subscribed to the ${selectedPlan.charAt(0).toUpperCase() + selectedPlan.slice(1)} Plan! Thank you!`);
            closeSubscribeModal();
        }

        function switchTab(tabName) {
            // Close menu when a tab is selected
            document.querySelector('.menu').classList.remove('active');
            document.querySelector('.hamburger').classList.remove('active');
            
            // Hide all content
            document.querySelectorAll('.content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab-btn').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Activate the selected tab
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // Show the selected content
            if (tabName === 'photos') {
                document.getElementById('photos-content').classList.add('active');
            } else if (tabName === 'reels') {
                document.getElementById('reels-content').classList.add('active');
            } else if (tabName === 'exclusive') {
                document.getElementById('exclusive-content').classList.add('active');
            } else if (tabName === 'chat') {
                document.getElementById("openChat").click();
            } else {
                alert(`The ${tabName} section is coming soon!`);
            }
        }

        /* Tabs */
        document.querySelectorAll(".tab-btn").forEach(b => {
            b.onclick = () => {
                document.querySelectorAll(".tab-btn").forEach(x => x.classList.remove("active"));
                document.querySelectorAll(".content").forEach(c => c.classList.remove("active"));
                b.classList.add("active");
                switchTab(b.dataset.tab);
            };
        });

        /* Chat */
        const chatScreen = document.getElementById("chatScreen");
        const openChat = document.getElementById("openChat");
        const backToMain = document.getElementById("backToMain");
        const chatMessages = document.getElementById("chatMessages");
        const chatInput = document.getElementById("chatInput");
        const sendMessage = document.getElementById("sendMessage");

        function addMessage(text, sender = "creator") {
            const wrapper = document.createElement("div");
            wrapper.className = "msg-wrapper";
            if (sender === "creator") wrapper.style.alignItems = "flex-start";
            const msg = document.createElement("div");
            msg.className = "msg " + (sender === "creator" ? "creator-msg" : "user-msg");
            msg.textContent = text;
            wrapper.appendChild(msg);
            chatMessages.appendChild(wrapper);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return wrapper;
        }
        function addSeen(wrapper) {
            const seen = document.createElement("div");
            seen.className = "seen";
            seen.textContent = "Seen";
            wrapper.appendChild(seen);
        }
        function showTyping() {
            const typing = document.createElement("div");
            typing.className = "typing";
            typing.textContent = "Sofia is typing...";
            chatMessages.appendChild(typing);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return typing;
        }
        openChat.onclick = () => {
            // Hide main header when chat is opened
            document.querySelector('.header').style.display = 'none';
            
            chatScreen.style.display = "flex";
            document.querySelector(".main-screen").style.display = "none";
            chatMessages.innerHTML = "";
            setTimeout(() => {
                const msg = addMessage("Welcome to my chat! ", "creator");
                // Add speech bubble SVG
                const svg = document.createElement('svg');
                svg.innerHTML = '<path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>';
                svg.setAttribute('class', 'svg-icon');
                svg.setAttribute('viewBox', '0 0 24 24');
                svg.setAttribute('width', '16');
                svg.setAttribute('height', '16');
                svg.style.fill = 'currentColor';
                svg.style.marginLeft = '4px';
                svg.style.display = 'inline-block';
                msg.querySelector('.msg').appendChild(svg);
            }, 400);
        };
        backToMain.onclick = () => {
            // Show main header again when returning from chat
            document.querySelector('.header').style.display = 'flex';
            
            chatScreen.style.display = "none";
            document.querySelector(".main-screen").style.display = "block";
        };
        sendMessage.onclick = () => {
            const text = chatInput.value.trim();
            if (text) {
                const wrapper = addMessage(text, "user");
                chatInput.value = "";
                setTimeout(() => {
                    addSeen(wrapper);
                    const typingIndicator = showTyping();
                    setTimeout(() => {
                        typingIndicator.remove();
                        const reply = addMessage("Check this out 👉 https://mywebsite.com", "creator");
                        reply.querySelector(".msg").innerHTML = 'Check this out 👉 <a href="https://mywebsite.com" target="_blank">https://mywebsite.com</a>';
                    }, 3000);
                }, 2000);
            }
        };
        chatInput.addEventListener("keypress", e => { if (e.key === "Enter") sendMessage.click(); });

        /* Donation Modals */
        const donateModal = document.getElementById("chooseMethodModal");
        const btcDonateModal = document.getElementById("btcDonateModal");
        const openDonate = document.getElementById("openDonate");
        const closeDonate = document.getElementById("closeDonate");
        const openBtcDonate = document.getElementById("openBtcDonate");
        const closeBtcDonate = document.getElementById("closeBtcDonate");
        const backToDonate = document.getElementById("backToDonate");
        const copyBtcAddress = document.getElementById("copyBtcAddress");
        const donateBtcNow = document.getElementById("donateBtcNow");
        const btcAddress = document.getElementById("btcAddress").textContent.trim();

        openDonate.onclick = () => donateModal.style.display = "flex";
        closeDonate.onclick = () => donateModal.style.display = "none";
        openBtcDonate.onclick = () => {
            donateModal.style.display = "none";
            btcDonateModal.style.display = "flex";
        };
        closeBtcDonate.onclick = () => btcDonateModal.style.display = "none";
        backToDonate.onclick = () => {
            btcDonateModal.style.display = "none";
            donateModal.style.display = "flex";
        };
        copyBtcAddress.onclick = () => {
            navigator.clipboard.writeText(btcAddress).then(() => {
                const s = document.getElementById("statusMessage");
                s.textContent = "Address copied! ";
                s.className = "status-message status-success";
                s.style.display = "block";
                
                // Add clipboard SVG
                const svg = document.createElement('svg');
                svg.innerHTML = '<path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>';
                svg.setAttribute('class', 'svg-icon');
                svg.setAttribute('viewBox', '0 0 24 24');
                svg.setAttribute('width', '16');
                svg.setAttribute('height', '16');
                svg.style.fill = '#28a745';
                svg.style.marginLeft = '4px';
                svg.style.display = 'inline-block';
                s.appendChild(svg);
                
                setTimeout(() => s.style.display = "none", 3000);
            }).catch(() => {
                const s = document.getElementById("statusMessage");
                s.textContent = "Failed to copy";
                s.className = "status-message status-error";
                s.style.display = "block";
                setTimeout(() => s.style.display = "none", 3000);
            });
        };
        donateBtcNow.onclick = () => {
            window.open("https://www.blockchain.com/explorer/addresses/btc/" + btcAddress, "_blank");
            btcDonateModal.style.display = "none";
        };

        /* Stories */
        const profilePic = document.getElementById("profilePic");
        const storyModal = document.getElementById("storyModal");
        const storyContainer = document.getElementById("storyContainer");
        const storyCloseBtn = document.getElementById("storyCloseBtn");
        const prevStoryBtn = document.getElementById("prevStoryBtn");
        const nextStoryBtn = document.getElementById("nextStoryBtn");
        const storyImages = document.querySelectorAll(".story-image");
        const progressBars = document.getElementById("progressBars");
        const storyCount = document.getElementById("storyCount");
        const replyInput = document.getElementById("replyInput");
        const sendStoryBtn = document.getElementById("sendStoryBtn");
        const likeStoryBtn = document.getElementById("likeStoryBtn");
        let currentStory = 0, timer, total = storyImages.length;
        const duration = 10000;
        let isLiked = false;

        function createBars() {
            progressBars.innerHTML = "";
            storyImages.forEach(() => {
                let b = document.createElement("div");
                b.className = "progress-bar";
                let f = document.createElement("div");
                f.className = "progress-bar-fill";
                b.appendChild(f);
                progressBars.appendChild(b);
            });
        }
        function showStory(i) {
            clearTimeout(timer);
            storyImages.forEach(im => im.classList.remove("active"));
            storyImages[i].classList.add("active");
            let fills = document.querySelectorAll(".progress-bar-fill");
            fills.forEach((f, j) => {
                f.style.transition = "none";
                f.style.width = j < i ? "100%" : "0%";
            });
            void progressBars.offsetWidth;
            fills[i].style.transition = `width ${duration}ms linear`;
            requestAnimationFrame(() => fills[i].style.width = "100%");
            storyCount.textContent = `${i + 1}/${total}`;
            currentStory = i;
            isLiked = false;
            likeStoryBtn.classList.remove("liked");
            updateNav();
        }
        function updateNav() {
            prevStoryBtn.classList.toggle("visible", currentStory > 0);
            nextStoryBtn.classList.toggle("visible", currentStory < total - 1);
        }
        function start() {
            timer = setTimeout(() => {
                if (currentStory < total - 1) {
                    showStory(currentStory + 1);
                    start();
                } else closeStory();
            }, duration);
        }
        function closeStory() {
            clearTimeout(timer);
            storyModal.style.display = "none";
            currentStory = 0;
            replyInput.value = "";
            sendStoryBtn.classList.remove("visible");
        }
        profilePic.onclick = () => {
            storyModal.style.display = "flex";
            createBars();
            showStory(0);
            start();
        };
        storyCloseBtn.onclick = closeStory;
        replyInput.oninput = () => sendStoryBtn.classList.toggle("visible", !!replyInput.value.trim());
        sendStoryBtn.onclick = () => {
            if (replyInput.value.trim()) {
                alert("Reply: " + replyInput.value);
                replyInput.value = "";
                sendStoryBtn.classList.remove("visible");
            }
        };
        likeStoryBtn.onclick = () => {
            isLiked = !isLiked;
            likeStoryBtn.classList.toggle("liked", isLiked);
        };
        prevStoryBtn.onclick = () => {
            if (currentStory > 0) {
                clearTimeout(timer);
                showStory(currentStory - 1);
                start();
            }
        };
        nextStoryBtn.onclick = () => {
            if (currentStory < total - 1) {
                clearTimeout(timer);
                showStory(currentStory + 1);
                start();
            } else closeStory();
        };

        /* Comment Modal Functions */
        function openCommentModal(mediaId) {
            const modalOverlay = document.getElementById('commentModalOverlay');
            const modalBody = document.getElementById('commentModalBody');
            
            // Clear previous comments
            modalBody.innerHTML = '';
            
            // Get comments for this media item or use default if none exist
            const comments = commentsData[mediaId] || [
                { author: "John Doe", text: "This is absolutely stunning! The colors are so vibrant.", time: "2 hours ago" },
                { author: "Sarah Smith", text: "I've been to this location and the photo doesn't even do it justice!", time: "5 hours ago" }
            ];
            
            // Add comments to modal
            comments.forEach(comment => {
                const commentEl = document.createElement('div');
                commentEl.className = 'comment';
                commentEl.innerHTML = `
                    <div class="comment-header">
                        <div class="comment-author">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                            </svg>
                            ${comment.author}
                        </div>
                        <div class="comment-time">${comment.time}</div>
                    </div>
                    <p class="comment-text">${comment.text}</p>
                `;
                modalBody.appendChild(commentEl);
            });
            
            // Show the modal
            modalOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeCommentModal(event) {
            // Only close if clicking on overlay (not the modal content) or the close button
            if (event.target === document.getElementById('commentModalOverlay') || event.target.closest('.close-btn')) {
                const modalOverlay = document.getElementById('commentModalOverlay');
                modalOverlay.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }
        
        function addComment(event) {
            event.preventDefault();
            
            const nameInput = document.getElementById('commentName');
            const commentInput = document.getElementById('commentText');
            
            if (nameInput.value.trim() && commentInput.value.trim()) {
                const commentSection = document.getElementById('commentModalBody');
                
                // Create new comment element
                const newComment = document.createElement('div');
                newComment.className = 'comment';
                newComment.innerHTML = `
                    <div class="comment-header">
                        <div class="comment-author">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                            </svg>
                            ${nameInput.value}
                        </div>
                        <div class="comment-time">Just now</div>
                    </div>
                    <p class="comment-text">${commentInput.value}</p>
                `;
                
                // Add to the top of comments
                commentSection.insertBefore(newComment, commentSection.firstChild);
                
                // Clear form
                nameInput.value = '';
                commentInput.value = '';
                
                // Show notification
                alert('Comment added successfully!');
            }
        }
    </script>
</body>
</html>
